<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fonctions</title>
</head>

<body>

    <h1 id="moulin"></h1>

    <script>
        // Une fonction permet d'oganiser sont code
        // Une fonction doit être définie et peut être appelée
        // Elle évite le code répétitif et parfois, elle renvoie un résultat
        // Si la fonction ne renvoie pas de résultat, on appelle ça une procédure

        function moulin(ingredient){
            console.log(ingredient);

            if (ingredient == "cacao") {
                return "impossible"; //Le return arrête la fonction
            }

            console.log("toto"); //Fais quelque chose
            return "Je transforme le " + ingredient; //Retourne quelque chose que je peux afficher plus tard
        }

        console.log(moulin("blé").toLocaleUpperCase());
        console.log(moulin("avoine") + " et " + moulin("colza"));
        console.log("cacao");
        dom("#moulin").textContent = moulin("seigle");

        //Un helper aide le développeur à racourcir le code
        function dom(element){
            return document.querySelector(element);
        }

        function click(element, callback) {
            dom(element).addEventListener("click", callback);
        }
        
        //Une fonction peut être un argument
        click("#moulin", function () {
            alert("ok");
        });

        // La portée des variables en JS
        var prenom = "Fiorella";

        console.log(prenom);

        mondePerdu();

        function mondePerdu() { //Chaque fonction à son "scope", sa portée
            var nom = "Mota"; //Accessible uniquement dans la fonction
            console.log(prenom); // Prénom est accessible partout
            prenom = "Matthieu";

            function mondeEncorePlusPerdu() {
                console.log(prenom + " " + nom);
                covid = true; //Cette variable est globale et accessible de partout
            }
            mondeEncorePlusPerdu(); // Utilisable que dans mondePerdu()
        }

        console.log(prenom); //Matthieu
        console.log(covid); //affiche true
        console.log(nom); //undefined
        mondeEncorePlusPerdu(); // undefined


        //En JS on peut faire des var, des let et des const
        const PI = 3.14; //Une contante ne varie jamais

        //Le let bloque la variable dans un if, for ou while
        var i = 45;
        for (let i = 0; i < 10; i++) {
            console.log(i);
        }

        console.log(i); // Sans let, i vaut 10. Avec let i vaut 45

        //Les fonctions fléchées -> Racourcir pour écrire une fonction
        let moulin2 = (ingredient) => "Je transforme le " + ingredient;

        //Sur plusieurs lignes
        let moulins3 = (ingredient) => {
            console.log(ingredient);
            return "toto";
        }

        //La template de string (backquotes)
        let moulin4 = (ingredient) => `Je transforme le &{ingredient}`;
        console.log(moulin2("blé"));
        console.log(moulin3("blé"));
        console.log(moulin("blé"));
    </script>
    
</body>
</html>